/*ゲームを作ってみたい。
やりたいこと
・コマンド制をやってみよう
・コマンドは英語だけにしておく*/

#include <stdio.h>
#include <stdlib.h>

FILE *fp;

int d[32][18] = {0};//画面
int I;//コマンド
int X = 16, Y = 9;//座標
int debug = 0;//デバッグ用
int power = 1;
char ROD[288];
char raw[2];

int UI();
int COM();
int ML();

int main(void)
{
  fp = fopen(".map", "rb");

  ML();
  d[X][Y] = 1;

  while(power)
  {
    UI();

    if(debug != 0) printf("\nX=%d, Y=%d", X, Y);

  	printf("\n入力:");
	  scanf("%d", &I);

  	d[X][Y] = 0;
	  COM();
	  X = X < 32 ? (-1 < X ? X : 31) : 0;
	  Y = Y < 18 ? (-1 < Y ? Y : 17) : 0;
	  d[X][Y] = -1;

	  I = 0;
  }
  fclose(fp);

	return 0;
}

int UI()
{
	for(int i = 0; i < 18; i++)
	{
		if(i == 0)
		{
			for(int k = 0; k < 64; k++) printf("=");
			printf("\n");
		}

		for(int k = 0; k < 32; k++)
		{
		    switch(d[i][k])
			{
			    case 0:
					printf(",,");
				break;

				case 1:
				    printf("私");
				break;

				case 2:
				    printf("[]");
				break;
			}
		}
		printf("\n");
	}
	for(int k = 0; k < 64; k++) printf("=");

  return 0;
}

int COM()
{
	switch(I)
	{
		case -1:
			if(debug == 0) debug = 1;
			else debug = 0;
		break;

		case 0:
			power = 0;
		break;

		case 5:
		break;

		case 8:
			Y--;
		break;

		case 6:
			X++;
		break;

		case 2:
			Y++;
		break;

		case 4:
			X--;
		break;

		case 9:
		X = 0; Y = 0;
		break;
	}
	return 0;
}

int ML()
{
    for(int i = 0; i < 18; i++)
    {
        fread(ROD, 16, fp);
        raw[0] = ROD >> 4;
        raw[1] = ROD % 16;

        for(int k = 0; k < 32; k += 2)
        {
            d[k][i] = atoi(raw[0]);
            d[k + 1][i] = atoi(raw[1]);
        }
    }
    return 0;
}



//メモ↓
//マップ移動はバグ多そう。
/* デ-タについて
0.何もなし。",,"で表現。
1.プレイヤー。"私"で仮置き（後々変えるかも）
2.不可壊の壁。"[]"で表現。
*/
/*マップの描画方法に関して
dに読み込んだバイナリぶち込んだほうがいいかも*/
